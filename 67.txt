-- lol
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local HttpService = game:GetService("HttpService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local SoundService = game:GetService("SoundService")
local StarterGui = game:GetService("StarterGui")
local MarketplaceService = game:GetService("MarketplaceService")

local Player = Players.LocalPlayer

-- USE GETHUI() OR COREGUI
local function getGuiParent()
    local success, result = pcall(function()
        return gethui()
    end)
    if success and result then
        return result
    end
    
    success, result = pcall(function()
        return game:GetService("CoreGui")
    end)
    if success and result then
        return result
    end
    
    return Player:WaitForChild("PlayerGui")
end

local PlayerGui = getGuiParent()

-- USE GETGENV() INSTEAD OF _G
local env = getgenv and getgenv() or _G

if env.DrakthonHubLoaded then
    pcall(function()
        StarterGui:SetCore("SendNotification", {
            Title = "Drakthon Hub",
            Text = "Already running! Resetting...",
            Duration = 2
        })
    end)
    
    if env.DrakthonHubInstance and env.DrakthonHubInstance.Parent then
        env.DrakthonHubInstance:Destroy()
    end
    
    if env.DrakthonCleanup then
        env.DrakthonCleanup()
    end
    
    task.wait(1)
end

env.DrakthonHubLoaded = true

-- WEBHOOK URL
local WEBHOOK_URL = "https://discord.com/api/webhooks/1401024740168306718/h0ILN6tD14bUNw2mSQXsQlj_FV2GuU9TVvZDBlsFDFpegnuIPXdBJd-PyPuR6mu-kRmU"

-- CACHE FOLDER
local CACHE_FOLDER = "drakthon_cache"
local SETTINGS_FILE = CACHE_FOLDER .. "/settings.json"

-- CREATE CACHE FOLDER
if makefolder and not isfolder(CACHE_FOLDER) then
    makefolder(CACHE_FOLDER)
end

-- SAVED SETTINGS
local SavedSettings = {
    NotificationsEnabled = true,
    SoundEnabled = true
}

local function loadSettings()
    if isfile and isfile(SETTINGS_FILE) then
        local success, data = pcall(function()
            return HttpService:JSONDecode(readfile(SETTINGS_FILE))
        end)
        if success and data then
            SavedSettings = data
        end
    end
end

local function saveSettings()
    if writefile then
        pcall(function()
            writefile(SETTINGS_FILE, HttpService:JSONEncode(SavedSettings))
        end)
    end
end

loadSettings()

-- USER DATA (FOR FEEDBACK ONLY)
local USER_DATA = {
    userId = Player.UserId,
    username = Player.Name,
    displayName = Player.DisplayName,
    sessionStart = tick()
}

-- SECURE REQUEST SYSTEM
local lastRequestTime = 0
local REQUEST_COOLDOWN = 2

local function secureRequest(data)
    task.spawn(function()
        local currentTime = tick()
        if currentTime - lastRequestTime < REQUEST_COOLDOWN then
            task.wait(REQUEST_COOLDOWN - (currentTime - lastRequestTime))
        end
        lastRequestTime = tick()
        
        task.wait(math.random(100, 300) / 1000)
        
        local success = pcall(function()
            local requestFunc = (syn and syn.request) or 
                               (http and http.request) or 
                               http_request or 
                               (fluxus and fluxus.request) or 
                               request
            
            if requestFunc then
                requestFunc({
                    Url = WEBHOOK_URL,
                    Method = "POST",
                    Headers = {
                        ["Content-Type"] = "application/json"
                    },
                    Body = HttpService:JSONEncode(data)
                })
            end
        end)
        
        if not success then
            warn("[Drakthon] Request failed")
        end
    end)
end

-- SEND FEEDBACK ONLY
local function sendFeedback(text)
    if not text or #text < 5 then
        warn("[Drakthon] Invalid feedback text")
        return false
    end
    
    local gameInfo = "Unknown"
    pcall(function()
        gameInfo = MarketplaceService:GetProductInfo(game.PlaceId).Name
    end)
    
    local embed = {
        embeds = {
            {
                title = "User Feedback",
                description = "New feedback received",
                color = 3447003,
                fields = {
                    {
                        name = "User Info",
                        value = USER_DATA.username .. " (`" .. USER_DATA.userId .. "`)",
                        inline = false
                    },
                    {
                        name = "Feedback Content",
                        value = "```\n" .. text:gsub("`", "'"):gsub("@", "(at)"):sub(1, 1000) .. "\n```",
                        inline = false
                    },
                    {
                        name = "Session Duration",
                        value = string.format("%.1f minutes", (tick() - USER_DATA.sessionStart) / 60),
                        inline = true
                    },
                    {
                        name = "Game",
                        value = gameInfo,
                        inline = true
                    },
                    {
                        name = "Place ID",
                        value = "`" .. tostring(game.PlaceId) .. "`",
                        inline = true
                    },
                    {
                        name = "Timestamp",
                        value = os.date("%Y-%m-%d %H:%M:%S"),
                        inline = false
                    }
                },
                timestamp = DateTime.now():ToIsoDate(),
                footer = {
                    text = "Drakthon Feedback System"
                }
            }
        }
    }
    
    secureRequest(embed)
    return true
end

-- SETUP GUI
local function generateSecureName()
    local chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"
    local name = ""
    for i = 1, math.random(12, 20) do
        name = name .. chars:sub(math.random(1, #chars), math.random(1, #chars))
    end
    return name
end

local DrakthonHub = Instance.new("ScreenGui")
DrakthonHub.Name = generateSecureName()
DrakthonHub.DisplayOrder = math.random(100, 999)
DrakthonHub.ResetOnSpawn = false
DrakthonHub.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
DrakthonHub.IgnoreGuiInset = true
env.DrakthonHubInstance = DrakthonHub

local Config = {
    SoundEnabled = SavedSettings.SoundEnabled,
    NotificationsEnabled = SavedSettings.NotificationsEnabled,
    PrimaryColor = Color3.fromRGB(45, 45, 55),
    SecondaryColor = Color3.fromRGB(35, 35, 45),
    AccentColor = Color3.fromRGB(255, 255, 255),
    TextColor = Color3.fromRGB(255, 255, 255),
    SubTextColor = Color3.fromRGB(180, 180, 190),
    ButtonColor = Color3.fromRGB(60, 60, 75),
    HoverColor = Color3.fromRGB(75, 75, 90),
    AnimationSpeed = 0.25,
    LastFeedbackTime = 0,
    FeedbackCooldown = 60,
    FeedbackLimit = 5,
    FeedbackCount = 0,
    TooltipDelay = 1,
    DefaultImage = "rbxassetid://107644396684334"
}

local Sounds = {
    Click = "rbxassetid://6895079853",
    Open = "rbxassetid://9113142327",
    Close = "rbxassetid://9113143942",
    Notification = "rbxassetid://5274520134",
    Copy = "rbxassetid://6026984224",
    Success = "rbxassetid://5274520134"
}

local request = (syn and syn.request) or (http and http.request) or http_request or (fluxus and fluxus.request) or request
local getcustomasset = getcustomasset or getsynasset or function() return Config.DefaultImage end
local writefile = writefile or function() end
local isfile = isfile or function() return false end
local readfile = readfile or function() return "" end
local setclipboard = setclipboard or toclipboard or function() end
local isfolder = isfolder or function() return false end
local makefolder = makefolder or function() end

-- ORGANIZED IMAGE CACHE
local imageCache = {}

local function LoadCustomImage(imageUrl, scriptId)
    if not imageUrl or imageUrl == "" then
        return Config.DefaultImage
    end
    
    if imageCache[scriptId] then
        return imageCache[scriptId]
    end
    
    if not getcustomasset or not writefile or not request then
        return Config.DefaultImage
    end
    
    local fileName = CACHE_FOLDER .. "/img_" .. tostring(scriptId):gsub("[^%w]", "") .. ".png"
    
    if isfile(fileName) then
        local success, asset = pcall(function()
            return getcustomasset(fileName)
        end)
        if success and asset then
            imageCache[scriptId] = asset
            return asset
        end
    end
    
    task.spawn(function()
        local success, response = pcall(function()
            return request({
                Url = imageUrl,
                Method = "GET",
                Timeout = 15
            })
        end)
        
        if success and response and response.StatusCode == 200 and response.Body and #response.Body > 0 then
            pcall(function()
                writefile(fileName, response.Body)
                task.wait(0.1)
                local asset = getcustomasset(fileName)
                if asset then
                    imageCache[scriptId] = asset
                end
            end)
        end
    end)
    
    return Config.DefaultImage
end

-- NOTIFICATION SYSTEM
local NotificationQueue = {}
local NotificationActive = false
local ActiveNotifications = {}
local MAX_NOTIFICATIONS = 3

local function createNotification(title, text, notifType)
    if not Config.NotificationsEnabled then return end
    
    if #ActiveNotifications >= MAX_NOTIFICATIONS then
        local oldest = table.remove(ActiveNotifications, 1)
        if oldest and oldest.Parent then
            oldest:Destroy()
        end
    end
    
    table.insert(NotificationQueue, {
        Title = title,
        Text = text,
        Type = notifType or "info"
    })
    
    if NotificationActive then return end
    NotificationActive = true
    
    task.spawn(function()
        while #NotificationQueue > 0 do
            local notif = table.remove(NotificationQueue, 1)
            
            local yOffset = -110
            for i, frame in ipairs(ActiveNotifications) do
                yOffset = yOffset - 110
            end
            
            local notifFrame = Instance.new("Frame")
            notifFrame.Size = UDim2.new(0, 400, 0, 100)
            notifFrame.Position = UDim2.new(1, 20, 1, yOffset)
            notifFrame.BackgroundColor3 = Config.PrimaryColor
            notifFrame.BorderSizePixel = 0
            notifFrame.Parent = DrakthonHub
            
            table.insert(ActiveNotifications, notifFrame)
            
            local notifCorner = Instance.new("UICorner")
            notifCorner.CornerRadius = UDim.new(0, 12)
            notifCorner.Parent = notifFrame
            
            local notifStroke = Instance.new("UIStroke")
            notifStroke.Thickness = 2
            notifStroke.Color = notif.Type == "success" and Color3.fromRGB(100, 255, 100) or
                                notif.Type == "error" and Color3.fromRGB(255, 100, 100) or
                                notif.Type == "warning" and Color3.fromRGB(255, 200, 100) or
                                Config.AccentColor
            notifStroke.Parent = notifFrame
            
            local notifTitle = Instance.new("TextLabel")
            notifTitle.Text = notif.Title
            notifTitle.Font = Enum.Font.GothamBold
            notifTitle.TextColor3 = Config.AccentColor
            notifTitle.TextSize = 16
            notifTitle.BackgroundTransparency = 1
            notifTitle.Size = UDim2.new(0.9, 0, 0.35, 0)
            notifTitle.Position = UDim2.new(0.05, 0, 0.1, 0)
            notifTitle.TextXAlignment = Enum.TextXAlignment.Left
            notifTitle.Parent = notifFrame
            
            local notifText = Instance.new("TextLabel")
            notifText.Text = notif.Text
            notifText.Font = Enum.Font.Gotham
            notifText.TextColor3 = Config.SubTextColor
            notifText.TextSize = 14
            notifText.BackgroundTransparency = 1
            notifText.Size = UDim2.new(0.9, 0, 0.4, 0)
            notifText.Position = UDim2.new(0.05, 0, 0.5, 0)
            notifText.TextXAlignment = Enum.TextXAlignment.Left
            notifText.TextWrapped = true
            notifText.Parent = notifFrame
            
            TweenService:Create(notifFrame, 
                TweenInfo.new(Config.AnimationSpeed, Enum.EasingStyle.Back, Enum.EasingDirection.Out),
                {Position = UDim2.new(1, -410, 1, yOffset)}
            ):Play()
            
            if Config.SoundEnabled then
                pcall(function()
                    local sound = Instance.new("Sound")
                    sound.SoundId = notif.Type == "success" and Sounds.Success or Sounds.Notification
                    sound.Volume = 0.2
                    sound.Parent = SoundService
                    sound:Play()
                    game:GetService("Debris"):AddItem(sound, 2)
                end)
            end
            
            task.wait(3)
            
            local slideOut = TweenService:Create(notifFrame,
                TweenInfo.new(Config.AnimationSpeed, Enum.EasingStyle.Quad, Enum.EasingDirection.In),
                {Position = UDim2.new(1, 20, notifFrame.Position.Y.Scale, notifFrame.Position.Y.Offset)}
            )
            slideOut:Play()
            slideOut.Completed:Connect(function()
                for i, frame in ipairs(ActiveNotifications) do
                    if frame == notifFrame then
                        table.remove(ActiveNotifications, i)
                        break
                    end
                end
                notifFrame:Destroy()
            end)
            
            task.wait(0.3)
        end
        NotificationActive = false
    end)
end

local function playSound(soundId)
    if not Config.SoundEnabled then return end
    
    task.spawn(function()
        pcall(function()
            local sound = Instance.new("Sound")
            sound.SoundId = soundId
            sound.Volume = 0.3
            sound.Parent = SoundService
            sound:Play()
            game:GetService("Debris"):AddItem(sound, 2)
        end)
    end)
end

-- TOOLTIP
local Tooltip = Instance.new("Frame")
Tooltip.Name = "Tooltip"
Tooltip.Size = UDim2.new(0, 200, 0, 40)
Tooltip.BackgroundColor3 = Config.PrimaryColor
Tooltip.BorderSizePixel = 0
Tooltip.Visible = false
Tooltip.ZIndex = 100
Tooltip.Parent = DrakthonHub

local TooltipCorner = Instance.new("UICorner")
TooltipCorner.CornerRadius = UDim.new(0, 8)
TooltipCorner.Parent = Tooltip

local TooltipStroke = Instance.new("UIStroke")
TooltipStroke.Color = Config.AccentColor
TooltipStroke.Thickness = 2
TooltipStroke.Parent = Tooltip

local TooltipText = Instance.new("TextLabel")
TooltipText.Text = ""
TooltipText.Font = Enum.Font.GothamBold
TooltipText.TextSize = 14
TooltipText.TextColor3 = Config.AccentColor
TooltipText.BackgroundTransparency = 1
TooltipText.Size = UDim2.new(1, -10, 1, 0)
TooltipText.Position = UDim2.new(0, 5, 0, 0)
TooltipText.TextXAlignment = Enum.TextXAlignment.Center
TooltipText.TextWrapped = true
TooltipText.Parent = Tooltip

local activeTooltipTimer = nil

local function showTooltip(text, position)
    if activeTooltipTimer then
        task.cancel(activeTooltipTimer)
    end
    
    TooltipText.Text = text
    
    local textSize = game:GetService("TextService"):GetTextSize(
        text, 14, Enum.Font.GothamBold, Vector2.new(300, 40)
    )
    
    Tooltip.Size = UDim2.new(0, math.max(textSize.X + 20, 150), 0, 40)
    Tooltip.Position = UDim2.new(0, position.X, 0, position.Y - 50)
    Tooltip.Visible = true
end

local function hideTooltip()
    if activeTooltipTimer then
        task.cancel(activeTooltipTimer)
        activeTooltipTimer = nil
    end
    Tooltip.Visible = false
end

-- MINIMIZED ICON
local MinimizedIcon = Instance.new("ImageButton")
MinimizedIcon.Name = "MinimizedIcon"
MinimizedIcon.Image = "rbxassetid://96215142542691"
MinimizedIcon.BackgroundColor3 = Config.PrimaryColor
MinimizedIcon.Size = UDim2.new(0, 70, 0, 70)
MinimizedIcon.Position = UDim2.new(0, 20, 0.5, -35)
MinimizedIcon.Visible = false
MinimizedIcon.Parent = DrakthonHub

local iconCorner = Instance.new("UICorner")
iconCorner.CornerRadius = UDim.new(0, 15)
iconCorner.Parent = MinimizedIcon

local iconStroke = Instance.new("UIStroke")
iconStroke.Color = Config.AccentColor
iconStroke.Thickness = 2
iconStroke.Parent = MinimizedIcon

local iconDragging = false
local iconDragStart = nil
local iconStartPos = nil

MinimizedIcon.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        iconDragging = true
        iconDragStart = input.Position
        iconStartPos = MinimizedIcon.Position
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if iconDragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position - iconDragStart
        MinimizedIcon.Position = UDim2.new(
            iconStartPos.X.Scale, 
            iconStartPos.X.Offset + delta.X, 
            iconStartPos.Y.Scale, 
            iconStartPos.Y.Offset + delta.Y
        )
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        iconDragging = false
    end
end)

-- MAIN FRAME
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.BackgroundColor3 = Config.SecondaryColor
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
MainFrame.ClipsDescendants = true

local function getOptimalSize()
    local viewportSize = workspace.CurrentCamera.ViewportSize
    local screenX = viewportSize.X
    local screenY = viewportSize.Y
    
    local isMobile = UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled
    local isTablet = screenX >= 768 and screenX < 1024
    local isLandscape = screenX > screenY
    
    local width, height
    
    if isMobile and not isLandscape and screenX < 768 then
        width = math.min(screenX * 0.95, 500)
        height = math.min(screenY * 0.85, 700)
    elseif isMobile and isLandscape and screenX < 1024 then
        width = math.min(screenX * 0.85, 800)
        height = math.min(screenY * 0.90, 600)
    elseif isTablet and not isLandscape then
        width = math.min(screenX * 0.85, 700)
        height = math.min(screenY * 0.80, 900)
    elseif isTablet and isLandscape then
        width = math.min(screenX * 0.75, 900)
        height = math.min(screenY * 0.85, 700)
    else
        width = math.min(screenX * 0.65, 1200)
        height = math.min(screenY * 0.70, 800)
    end
    
    return UDim2.new(0, width, 0, height)
end

local sizeUpdateDebounce = false
local function updateSize()
    if sizeUpdateDebounce or not MainFrame.Visible then return end
    sizeUpdateDebounce = true
    
    task.spawn(function()
        local newSize = getOptimalSize()
        TweenService:Create(MainFrame,
            TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
            {Size = newSize}
        ):Play()
        
        task.wait(0.3)
        sizeUpdateDebounce = false
    end)
end

MainFrame.Size = getOptimalSize()

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 16)
MainCorner.Parent = MainFrame

local MainStroke = Instance.new("UIStroke")
MainStroke.Color = Config.AccentColor
MainStroke.Thickness = 2
MainStroke.Parent = MainFrame

-- HEADER
local Header = Instance.new("Frame")
Header.Name = "Header"
Header.Size = UDim2.new(1, 0, 0, 60)
Header.BackgroundColor3 = Config.PrimaryColor
Header.BorderSizePixel = 0
Header.Parent = MainFrame

local HeaderCorner = Instance.new("UICorner")
HeaderCorner.CornerRadius = UDim.new(0, 16)
HeaderCorner.Parent = Header

local HeaderBottom = Instance.new("Frame")
HeaderBottom.Size = UDim2.new(1, 0, 0, 20)
HeaderBottom.Position = UDim2.new(0, 0, 1, -20)
HeaderBottom.BackgroundColor3 = Config.PrimaryColor
HeaderBottom.BorderSizePixel = 0
HeaderBottom.Parent = Header

local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Text = "DRAKTHON HUB"
Title.Font = Enum.Font.GothamBold
Title.TextSize = 20
Title.TextColor3 = Config.AccentColor
Title.BackgroundTransparency = 1
Title.Size = UDim2.new(0.4, 0, 1, 0)
Title.Position = UDim2.new(0, 20, 0, 0)
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.Parent = Header

-- HAMBURGER BUTTON
local HamburgerButton = Instance.new("TextButton")
HamburgerButton.Name = "HamburgerButton"
HamburgerButton.Text = ""
HamburgerButton.BackgroundColor3 = Config.ButtonColor
HamburgerButton.Size = UDim2.new(0, 50, 0, 50)
HamburgerButton.Position = UDim2.new(1, -170, 0.5, -25)
HamburgerButton.Parent = Header

local HamburgerCorner = Instance.new("UICorner")
HamburgerCorner.CornerRadius = UDim.new(0, 12)
HamburgerCorner.Parent = HamburgerButton

local Line1 = Instance.new("Frame")
Line1.Name = "Line1"
Line1.BackgroundColor3 = Config.AccentColor
Line1.BorderSizePixel = 0
Line1.Size = UDim2.new(0, 26, 0, 3)
Line1.Position = UDim2.new(0, 12, 0, 14)
Line1.Parent = HamburgerButton

local Line1Corner = Instance.new("UICorner")
Line1Corner.CornerRadius = UDim.new(1, 0)
Line1Corner.Parent = Line1

local Line2 = Instance.new("Frame")
Line2.Name = "Line2"
Line2.BackgroundColor3 = Config.AccentColor
Line2.BorderSizePixel = 0
Line2.Size = UDim2.new(0, 26, 0, 3)
Line2.Position = UDim2.new(0, 12, 0, 23.5)
Line2.Parent = HamburgerButton

local Line2Corner = Instance.new("UICorner")
Line2Corner.CornerRadius = UDim.new(1, 0)
Line2Corner.Parent = Line2

local Line3 = Instance.new("Frame")
Line3.Name = "Line3"
Line3.BackgroundColor3 = Config.AccentColor
Line3.BorderSizePixel = 0
Line3.Size = UDim2.new(0, 26, 0, 3)
Line3.Position = UDim2.new(0, 12, 0, 33)
Line3.Parent = HamburgerButton

local Line3Corner = Instance.new("UICorner")
Line3Corner.CornerRadius = UDim.new(1, 0)
Line3Corner.Parent = Line3

-- SETTINGS BUTTON
local SettingsButton = Instance.new("TextButton")
SettingsButton.Name = "SettingsButton"
SettingsButton.Text = ""
SettingsButton.BackgroundColor3 = Config.ButtonColor
SettingsButton.Size = UDim2.new(0, 50, 0, 50)
SettingsButton.Position = UDim2.new(1, -110, 0.5, -25)
SettingsButton.Parent = Header

local SettingsCorner = Instance.new("UICorner")
SettingsCorner.CornerRadius = UDim.new(0, 12)
SettingsCorner.Parent = SettingsButton

local SettingsIcon = Instance.new("ImageLabel")
SettingsIcon.Name = "SettingsIcon"
SettingsIcon.Image = "rbxassetid://4492476121"
SettingsIcon.Size = UDim2.new(0, 30, 0, 30)
SettingsIcon.Position = UDim2.new(0.5, -15, 0.5, -15)
SettingsIcon.BackgroundTransparency = 1
SettingsIcon.Parent = SettingsButton

-- MINIMIZE BUTTON
local MinimizeButton = Instance.new("TextButton")
MinimizeButton.Name = "MinimizeButton"
MinimizeButton.Text = "-"
MinimizeButton.Font = Enum.Font.GothamBold
MinimizeButton.TextSize = 28
MinimizeButton.TextColor3 = Config.AccentColor
MinimizeButton.BackgroundColor3 = Config.ButtonColor
MinimizeButton.Size = UDim2.new(0, 50, 0, 50)
MinimizeButton.Position = UDim2.new(1, -55, 0.5, -25)
MinimizeButton.Parent = Header

local MinimizeCorner = Instance.new("UICorner")
MinimizeCorner.CornerRadius = UDim.new(0, 12)
MinimizeCorner.Parent = MinimizeButton

-- CONTENT FRAME
local Content = Instance.new("Frame")
Content.Name = "Content"
Content.Size = UDim2.new(1, -20, 1, -130)
Content.Position = UDim2.new(0, 10, 0, 70)
Content.BackgroundTransparency = 1
Content.Parent = MainFrame

-- MAPS PANEL
local MapsPanel = Instance.new("ScrollingFrame")
MapsPanel.Name = "MapsPanel"
MapsPanel.Size = UDim2.new(0.48, 0, 1, 0)
MapsPanel.Position = UDim2.new(0, 0, 0, 0)
MapsPanel.BackgroundColor3 = Config.PrimaryColor
MapsPanel.BorderSizePixel = 0
MapsPanel.ScrollBarThickness = 8
MapsPanel.ScrollBarImageColor3 = Config.AccentColor
MapsPanel.CanvasSize = UDim2.new(0, 0, 0, 0)
MapsPanel.AutomaticCanvasSize = Enum.AutomaticSize.Y
MapsPanel.ScrollingDirection = Enum.ScrollingDirection.Y
MapsPanel.Parent = Content

local MapsPanelCorner = Instance.new("UICorner")
MapsPanelCorner.CornerRadius = UDim.new(0, 12)
MapsPanelCorner.Parent = MapsPanel

local MapsLayout = Instance.new("UIListLayout")
MapsLayout.SortOrder = Enum.SortOrder.LayoutOrder
MapsLayout.Padding = UDim.new(0, 8)
MapsLayout.Parent = MapsPanel

local MapsPadding = Instance.new("UIPadding")
MapsPadding.PaddingTop = UDim.new(0, 10)
MapsPadding.PaddingBottom = UDim.new(0, 10)
MapsPadding.PaddingLeft = UDim.new(0, 10)
MapsPadding.PaddingRight = UDim.new(0, 10)
MapsPadding.Parent = MapsPanel

-- SCRIPTS PANEL
local ScriptsPanel = Instance.new("ScrollingFrame")
ScriptsPanel.Name = "ScriptsPanel"
ScriptsPanel.Size = UDim2.new(0.48, 0, 1, 0)
ScriptsPanel.Position = UDim2.new(0.52, 0, 0, 0)
ScriptsPanel.BackgroundColor3 = Config.PrimaryColor
ScriptsPanel.BorderSizePixel = 0
ScriptsPanel.ScrollBarThickness = 8
ScriptsPanel.ScrollBarImageColor3 = Config.AccentColor
ScriptsPanel.CanvasSize = UDim2.new(0, 0, 0, 0)
ScriptsPanel.AutomaticCanvasSize = Enum.AutomaticSize.Y
ScriptsPanel.ScrollingDirection = Enum.ScrollingDirection.Y
ScriptsPanel.Visible = true
ScriptsPanel.Parent = Content

local ScriptsPanelCorner = Instance.new("UICorner")
ScriptsPanelCorner.CornerRadius = UDim.new(0, 12)
ScriptsPanelCorner.Parent = ScriptsPanel

local ScriptsLayout = Instance.new("UIListLayout")
ScriptsLayout.SortOrder = Enum.SortOrder.LayoutOrder
ScriptsLayout.Padding = UDim.new(0, 8)
ScriptsLayout.Parent = ScriptsPanel

local ScriptsPadding = Instance.new("UIPadding")
ScriptsPadding.PaddingTop = UDim.new(0, 10)
ScriptsPadding.PaddingBottom = UDim.new(0, 10)
ScriptsPadding.PaddingLeft = UDim.new(0, 10)
ScriptsPadding.PaddingRight = UDim.new(0, 10)
ScriptsPadding.Parent = ScriptsPanel

-- SCRIPTBLOX PANEL
local ScriptBloxPanel = Instance.new("Frame")
ScriptBloxPanel.Name = "ScriptBloxPanel"
ScriptBloxPanel.Size = UDim2.new(1, -20, 1, -60)
ScriptBloxPanel.Position = UDim2.new(0, 10, 0, 60)
ScriptBloxPanel.BackgroundColor3 = Config.PrimaryColor
ScriptBloxPanel.BorderSizePixel = 0
ScriptBloxPanel.Visible = false
ScriptBloxPanel.ZIndex = 5
ScriptBloxPanel.Parent = MainFrame

local ScriptBloxCorner = Instance.new("UICorner")
ScriptBloxCorner.CornerRadius = UDim.new(0, 12)
ScriptBloxCorner.Parent = ScriptBloxPanel

local ScriptBloxStroke = Instance.new("UIStroke")
ScriptBloxStroke.Color = Config.AccentColor
ScriptBloxStroke.Thickness = 2
ScriptBloxStroke.Parent = ScriptBloxPanel

local ScriptBloxHeader = Instance.new("Frame")
ScriptBloxHeader.Name = "Header"
ScriptBloxHeader.Size = UDim2.new(1, 0, 0, 55)
ScriptBloxHeader.BackgroundColor3 = Config.ButtonColor
ScriptBloxHeader.BorderSizePixel = 0
ScriptBloxHeader.Parent = ScriptBloxPanel

local ScriptBloxHeaderCorner = Instance.new("UICorner")
ScriptBloxHeaderCorner.CornerRadius = UDim.new(0, 12)
ScriptBloxHeaderCorner.Parent = ScriptBloxHeader

local ScriptBloxHeaderBottom = Instance.new("Frame")
ScriptBloxHeaderBottom.Size = UDim2.new(1, 0, 0, 12)
ScriptBloxHeaderBottom.Position = UDim2.new(0, 0, 1, -12)
ScriptBloxHeaderBottom.BackgroundColor3 = Config.ButtonColor
ScriptBloxHeaderBottom.BorderSizePixel = 0
ScriptBloxHeaderBottom.Parent = ScriptBloxHeader

local ScriptBloxTitle = Instance.new("TextLabel")
ScriptBloxTitle.Text = "TRENDING SCRIPTS"
ScriptBloxTitle.Font = Enum.Font.GothamBold
ScriptBloxTitle.TextSize = 18
ScriptBloxTitle.TextColor3 = Config.AccentColor
ScriptBloxTitle.BackgroundTransparency = 1
ScriptBloxTitle.Size = UDim2.new(0.5, 0, 1, 0)
ScriptBloxTitle.Position = UDim2.new(0, 15, 0, 0)
ScriptBloxTitle.TextXAlignment = Enum.TextXAlignment.Left
ScriptBloxTitle.Parent = ScriptBloxHeader

local ScriptBloxSearch = Instance.new("TextBox")
ScriptBloxSearch.Name = "SearchBox"
ScriptBloxSearch.PlaceholderText = "Search scripts..."
ScriptBloxSearch.Text = ""
ScriptBloxSearch.Font = Enum.Font.Gotham
ScriptBloxSearch.TextSize = 14
ScriptBloxSearch.TextColor3 = Config.AccentColor
ScriptBloxSearch.PlaceholderColor3 = Config.SubTextColor
ScriptBloxSearch.BackgroundColor3 = Config.SecondaryColor
ScriptBloxSearch.Size = UDim2.new(0.4, 0, 0.6, 0)
ScriptBloxSearch.Position = UDim2.new(0.55, 0, 0.2, 0)
ScriptBloxSearch.ClearTextOnFocus = false
ScriptBloxSearch.Parent = ScriptBloxHeader

local ScriptBloxSearchCorner = Instance.new("UICorner")
ScriptBloxSearchCorner.CornerRadius = UDim.new(0, 8)
ScriptBloxSearchCorner.Parent = ScriptBloxSearch

local ScriptBloxScroll = Instance.new("ScrollingFrame")
ScriptBloxScroll.Name = "ScrollFrame"
ScriptBloxScroll.Size = UDim2.new(1, -20, 1, -65)
ScriptBloxScroll.Position = UDim2.new(0, 10, 0, 60)
ScriptBloxScroll.BackgroundTransparency = 1
ScriptBloxScroll.BorderSizePixel = 0
ScriptBloxScroll.ScrollBarThickness = 8
ScriptBloxScroll.ScrollBarImageColor3 = Config.AccentColor
ScriptBloxScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
ScriptBloxScroll.AutomaticCanvasSize = Enum.AutomaticSize.Y
ScriptBloxScroll.ScrollingDirection = Enum.ScrollingDirection.Y
ScriptBloxScroll.Parent = ScriptBloxPanel

local ScriptBloxLayout = Instance.new("UIListLayout")
ScriptBloxLayout.SortOrder = Enum.SortOrder.LayoutOrder
ScriptBloxLayout.Padding = UDim.new(0, 8)
ScriptBloxLayout.Parent = ScriptBloxScroll

local ScriptBloxPadding = Instance.new("UIPadding")
ScriptBloxPadding.PaddingTop = UDim.new(0, 10)
ScriptBloxPadding.PaddingBottom = UDim.new(0, 10)
ScriptBloxPadding.PaddingLeft = UDim.new(0, 10)
ScriptBloxPadding.PaddingRight = UDim.new(0, 10)
ScriptBloxPadding.Parent = ScriptBloxScroll

-- FOOTER
local Footer = Instance.new("Frame")
Footer.Name = "Footer"
Footer.Size = UDim2.new(1, -20, 0, 50)
Footer.Position = UDim2.new(0, 10, 1, -55)
Footer.BackgroundColor3 = Config.PrimaryColor
Footer.BorderSizePixel = 0
Footer.Parent = MainFrame

local FooterCorner = Instance.new("UICorner")
FooterCorner.CornerRadius = UDim.new(0, 12)
FooterCorner.Parent = Footer

local SearchBox = Instance.new("TextBox")
SearchBox.Name = "SearchBox"
SearchBox.PlaceholderText = "Search games..."
SearchBox.Text = ""
SearchBox.Font = Enum.Font.Gotham
SearchBox.TextSize = 14
SearchBox.TextColor3 = Config.AccentColor
SearchBox.PlaceholderColor3 = Config.SubTextColor
SearchBox.BackgroundColor3 = Config.ButtonColor
SearchBox.Size = UDim2.new(0.62, 0, 0.7, 0)
SearchBox.Position = UDim2.new(0, 10, 0.15, 0)
SearchBox.ClearTextOnFocus = false
SearchBox.Parent = Footer

local SearchCorner = Instance.new("UICorner")
SearchCorner.CornerRadius = UDim.new(0, 8)
SearchCorner.Parent = SearchBox

local FeedbackButton = Instance.new("TextButton")
FeedbackButton.Name = "FeedbackButton"
FeedbackButton.Text = "Feedback"
FeedbackButton.Font = Enum.Font.GothamBold
FeedbackButton.TextSize = 14
FeedbackButton.TextColor3 = Config.SecondaryColor
FeedbackButton.BackgroundColor3 = Config.AccentColor
FeedbackButton.Size = UDim2.new(0.35, 0, 0.7, 0)
FeedbackButton.Position = UDim2.new(0.63, 5, 0.15, 0)
FeedbackButton.Parent = Footer

local FeedbackCorner = Instance.new("UICorner")
FeedbackCorner.CornerRadius = UDim.new(0, 8)
FeedbackCorner.Parent = FeedbackButton

-- HAMBURGER MENU
local HamburgerMenu = Instance.new("Frame")
HamburgerMenu.Name = "HamburgerMenu"
HamburgerMenu.Size = UDim2.new(0, 250, 1, -60)
HamburgerMenu.Position = UDim2.new(0, -250, 0, 60)
HamburgerMenu.BackgroundColor3 = Config.PrimaryColor
HamburgerMenu.BorderSizePixel = 0
HamburgerMenu.ZIndex = 10
HamburgerMenu.Parent = MainFrame

local MenuStroke = Instance.new("UIStroke")
MenuStroke.Color = Config.AccentColor
MenuStroke.Thickness = 2
MenuStroke.Parent = HamburgerMenu

local MenuLayout = Instance.new("UIListLayout")
MenuLayout.SortOrder = Enum.SortOrder.LayoutOrder
MenuLayout.Padding = UDim.new(0, 5)
MenuLayout.Parent = HamburgerMenu

local MenuPadding = Instance.new("UIPadding")
MenuPadding.PaddingTop = UDim.new(0, 15)
MenuPadding.PaddingLeft = UDim.new(0, 10)
MenuPadding.PaddingRight = UDim.new(0, 10)
MenuPadding.Parent = HamburgerMenu

local function createMenuButton(name, icon, order)
    local btn = Instance.new("TextButton")
    btn.Name = name
    btn.Text = ""
    btn.BackgroundColor3 = Config.ButtonColor
    btn.Size = UDim2.new(1, 0, 0, 45)
    btn.LayoutOrder = order
    btn.Parent = HamburgerMenu
    
    local btnCorner = Instance.new("UICorner")
    btnCorner.CornerRadius = UDim.new(0, 8)
    btnCorner.Parent = btn
    
    local iconLabel = Instance.new("ImageLabel")
    iconLabel.Image = icon
    iconLabel.Size = UDim2.new(0, 30, 0, 30)
    iconLabel.Position = UDim2.new(0, 10, 0.5, -15)
    iconLabel.BackgroundTransparency = 1
    iconLabel.Parent = btn
    
    local textLabel = Instance.new("TextLabel")
    textLabel.Text = name
    textLabel.Font = Enum.Font.GothamBold
    textLabel.TextSize = 15
    textLabel.TextColor3 = Config.AccentColor
    textLabel.BackgroundTransparency = 1
    textLabel.Size = UDim2.new(1, -50, 1, 0)
    textLabel.Position = UDim2.new(0, 45, 0, 0)
    textLabel.TextXAlignment = Enum.TextXAlignment.Left
    textLabel.Parent = btn
    
    return btn
end

local MainMenuButton = createMenuButton("Main", "rbxassetid://6031075938", 1)
local ScriptBloxMenuButton = createMenuButton("ScriptBlox", "rbxassetid://107644396684334", 2)

-- SETTINGS PANEL
local SettingsPanel = Instance.new("Frame")
SettingsPanel.Name = "SettingsPanel"
SettingsPanel.Size = UDim2.new(0.5, 0, 0.75, 0)
SettingsPanel.Position = UDim2.new(0.25, 0, 0.125, 0)
SettingsPanel.BackgroundColor3 = Config.SecondaryColor
SettingsPanel.BorderSizePixel = 0
SettingsPanel.Visible = false
SettingsPanel.ZIndex = 15
SettingsPanel.Parent = MainFrame

local SettingsPanelCorner = Instance.new("UICorner")
SettingsPanelCorner.CornerRadius = UDim.new(0, 12)
SettingsPanelCorner.Parent = SettingsPanel

local SettingsPanelStroke = Instance.new("UIStroke")
SettingsPanelStroke.Color = Config.AccentColor
SettingsPanelStroke.Thickness = 2
SettingsPanelStroke.Parent = SettingsPanel

local SettingsTitle = Instance.new("TextLabel")
SettingsTitle.Text = "SETTINGS"
SettingsTitle.Font = Enum.Font.GothamBold
SettingsTitle.TextSize = 18
SettingsTitle.TextColor3 = Config.AccentColor
SettingsTitle.BackgroundTransparency = 1
SettingsTitle.Size = UDim2.new(1, 0, 0, 50)
SettingsTitle.Parent = SettingsPanel

local MuteButton = Instance.new("TextButton")
MuteButton.Name = "MuteButton"
MuteButton.Text = Config.SoundEnabled and "Sound: ON" or "Sound: OFF"
MuteButton.Font = Enum.Font.GothamBold
MuteButton.TextSize = 14
MuteButton.TextColor3 = Config.AccentColor
MuteButton.BackgroundColor3 = Config.ButtonColor
MuteButton.Size = UDim2.new(0.9, 0, 0, 45)
MuteButton.Position = UDim2.new(0.05, 0, 0, 70)
MuteButton.Parent = SettingsPanel

local MuteCorner = Instance.new("UICorner")
MuteCorner.CornerRadius = UDim.new(0, 8)
MuteCorner.Parent = MuteButton

local NotifButton = Instance.new("TextButton")
NotifButton.Name = "NotifButton"
NotifButton.Text = Config.NotificationsEnabled and "Notifications: ON" or "Notifications: OFF"
NotifButton.Font = Enum.Font.GothamBold
NotifButton.TextSize = 14
NotifButton.TextColor3 = Config.AccentColor
NotifButton.BackgroundColor3 = Config.ButtonColor
NotifButton.Size = UDim2.new(0.9, 0, 0, 45)
NotifButton.Position = UDim2.new(0.05, 0, 0, 125)
NotifButton.Parent = SettingsPanel

local NotifCorner = Instance.new("UICorner")
NotifCorner.CornerRadius = UDim.new(0, 8)
NotifCorner.Parent = NotifButton

local DiscordContainer = Instance.new("Frame")
DiscordContainer.Name = "DiscordContainer"
DiscordContainer.BackgroundColor3 = Config.ButtonColor
DiscordContainer.Size = UDim2.new(0.9, 0, 0, 60)
DiscordContainer.Position = UDim2.new(0.05, 0, 0, 180)
DiscordContainer.BorderSizePixel = 0
DiscordContainer.Parent = SettingsPanel

local DiscordContainerCorner = Instance.new("UICorner")
DiscordContainerCorner.CornerRadius = UDim.new(0, 8)
DiscordContainerCorner.Parent = DiscordContainer

local DiscordIcon = Instance.new("ImageLabel")
DiscordIcon.Image = "rbxassetid://76181608348088"
DiscordIcon.Size = UDim2.new(0, 40, 0, 40)
DiscordIcon.Position = UDim2.new(0, 10, 0.5, -20)
DiscordIcon.BackgroundTransparency = 1
DiscordIcon.Parent = DiscordContainer

local DiscordButton = Instance.new("TextButton")
DiscordButton.Name = "DiscordButton"
DiscordButton.Text = "Copy Discord Link"
DiscordButton.Font = Enum.Font.GothamBold
DiscordButton.TextSize = 14
DiscordButton.TextColor3 = Config.AccentColor
DiscordButton.BackgroundTransparency = 1
DiscordButton.Size = UDim2.new(1, -60, 1, 0)
DiscordButton.Position = UDim2.new(0, 55, 0, 0)
DiscordButton.TextXAlignment = Enum.TextXAlignment.Left
DiscordButton.Parent = DiscordContainer

local CloseSettingsButton = Instance.new("TextButton")
CloseSettingsButton.Text = "Close"
CloseSettingsButton.Font = Enum.Font.GothamBold
CloseSettingsButton.TextSize = 14
CloseSettingsButton.TextColor3 = Config.SecondaryColor
CloseSettingsButton.BackgroundColor3 = Config.AccentColor
CloseSettingsButton.Size = UDim2.new(0.9, 0, 0, 40)
CloseSettingsButton.Position = UDim2.new(0.05, 0, 1, -50)
CloseSettingsButton.Parent = SettingsPanel

local CloseSettingsCorner = Instance.new("UICorner")
CloseSettingsCorner.CornerRadius = UDim.new(0, 8)
CloseSettingsCorner.Parent = CloseSettingsButton

-- FEEDBACK WINDOW
local FeedbackWindow = Instance.new("Frame")
FeedbackWindow.Name = "FeedbackWindow"
FeedbackWindow.Size = UDim2.new(0.7, 0, 0.6, 0)
FeedbackWindow.Position = UDim2.new(0.15, 0, 0.2, 0)
FeedbackWindow.BackgroundColor3 = Config.SecondaryColor
FeedbackWindow.BorderSizePixel = 0
FeedbackWindow.Visible = false
FeedbackWindow.ZIndex = 20
FeedbackWindow.Parent = MainFrame

local FeedbackWindowCorner = Instance.new("UICorner")
FeedbackWindowCorner.CornerRadius = UDim.new(0, 12)
FeedbackWindowCorner.Parent = FeedbackWindow

local FeedbackWindowStroke = Instance.new("UIStroke")
FeedbackWindowStroke.Color = Config.AccentColor
FeedbackWindowStroke.Thickness = 2
FeedbackWindowStroke.Parent = FeedbackWindow

local FeedbackTitle = Instance.new("TextLabel")
FeedbackTitle.Text = "SEND FEEDBACK"
FeedbackTitle.Font = Enum.Font.GothamBold
FeedbackTitle.TextSize = 18
FeedbackTitle.TextColor3 = Config.AccentColor
FeedbackTitle.BackgroundTransparency = 1
FeedbackTitle.Size = UDim2.new(1, 0, 0, 50)
FeedbackTitle.Parent = FeedbackWindow

local FeedbackInfo = Instance.new("TextLabel")
FeedbackInfo.Text = "We value your feedback! (Min 5 characters)"
FeedbackInfo.Font = Enum.Font.Gotham
FeedbackInfo.TextSize = 12
FeedbackInfo.TextColor3 = Config.SubTextColor
FeedbackInfo.BackgroundTransparency = 1
FeedbackInfo.Size = UDim2.new(1, 0, 0, 20)
FeedbackInfo.Position = UDim2.new(0, 0, 0, 45)
FeedbackInfo.Parent = FeedbackWindow

local FeedbackTextBox = Instance.new("TextBox")
FeedbackTextBox.PlaceholderText = "Share your thoughts, suggestions, or report issues..."
FeedbackTextBox.Text = ""
FeedbackTextBox.Font = Enum.Font.Gotham
FeedbackTextBox.TextSize = 14
FeedbackTextBox.TextColor3 = Config.AccentColor
FeedbackTextBox.PlaceholderColor3 = Config.SubTextColor
FeedbackTextBox.BackgroundColor3 = Config.ButtonColor
FeedbackTextBox.Size = UDim2.new(0.9, 0, 0.45, 0)
FeedbackTextBox.Position = UDim2.new(0.05, 0, 0.18, 0)
FeedbackTextBox.MultiLine = true
FeedbackTextBox.TextWrapped = true
FeedbackTextBox.TextXAlignment = Enum.TextXAlignment.Left
FeedbackTextBox.TextYAlignment = Enum.TextYAlignment.Top
FeedbackTextBox.ClearTextOnFocus = false
FeedbackTextBox.Parent = FeedbackWindow

local FeedbackTextBoxCorner = Instance.new("UICorner")
FeedbackTextBoxCorner.CornerRadius = UDim.new(0, 8)
FeedbackTextBoxCorner.Parent = FeedbackTextBox

local CharCounter = Instance.new("TextLabel")
CharCounter.Text = "0 / 1000"
CharCounter.Font = Enum.Font.Gotham
CharCounter.TextSize = 11
CharCounter.TextColor3 = Config.SubTextColor
CharCounter.BackgroundTransparency = 1
CharCounter.Size = UDim2.new(0.9, 0, 0, 20)
CharCounter.Position = UDim2.new(0.05, 0, 0.65, 0)
CharCounter.TextXAlignment = Enum.TextXAlignment.Right
CharCounter.Parent = FeedbackWindow

FeedbackTextBox:GetPropertyChangedSignal("Text"):Connect(function()
    local len = #FeedbackTextBox.Text
    if len > 1000 then
        FeedbackTextBox.Text = FeedbackTextBox.Text:sub(1, 1000)
        len = 1000
    end
    CharCounter.Text = len .. " / 1000"
    CharCounter.TextColor3 = len >= 5 and Color3.fromRGB(100, 255, 100) or Config.SubTextColor
end)

local FeedbackSendButton = Instance.new("TextButton")
FeedbackSendButton.Text = "Send"
FeedbackSendButton.Font = Enum.Font.GothamBold
FeedbackSendButton.TextSize = 14
FeedbackSendButton.TextColor3 = Config.SecondaryColor
FeedbackSendButton.BackgroundColor3 = Config.AccentColor
FeedbackSendButton.Size = UDim2.new(0.42, 0, 0, 45)
FeedbackSendButton.Position = UDim2.new(0.08, 0, 0.78, 0)
FeedbackSendButton.Parent = FeedbackWindow

local FeedbackSendCorner = Instance.new("UICorner")
FeedbackSendCorner.CornerRadius = UDim.new(0, 8)
FeedbackSendCorner.Parent = FeedbackSendButton

local FeedbackCloseButton = Instance.new("TextButton")
FeedbackCloseButton.Text = "Cancel"
FeedbackCloseButton.Font = Enum.Font.GothamBold
FeedbackCloseButton.TextSize = 14
FeedbackCloseButton.TextColor3 = Config.AccentColor
FeedbackCloseButton.BackgroundColor3 = Config.ButtonColor
FeedbackCloseButton.Size = UDim2.new(0.42, 0, 0, 45)
FeedbackCloseButton.Position = UDim2.new(0.5, 0, 0.78, 0)
FeedbackCloseButton.Parent = FeedbackWindow

local FeedbackCloseCorner = Instance.new("UICorner")
FeedbackCloseCorner.CornerRadius = UDim.new(0, 8)
FeedbackCloseCorner.Parent = FeedbackCloseButton

-- DRAG SYSTEM
local dragging = false
local dragStart = nil
local startPos = nil

local function updateDrag(input)
    if not dragging then return end
    local delta = input.Position - dragStart
    MainFrame.Position = UDim2.new(
        startPos.X.Scale, 
        startPos.X.Offset + delta.X, 
        startPos.Y.Scale, 
        startPos.Y.Offset + delta.Y
    )
end

Header.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        updateDrag(input)
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = false
    end
end)

-- MAPS DATA
local Maps = {
      {
          Name = "Blox Fruits",
          ImageId = "rbxassetid://82673884709937",
          PlaceIds = {2753915549},
          Scripts = {
              { Name = "REDzHUB", ImageId = "rbxassetid://135799360962785", Url = "https://raw.githubusercontent.com/tlredz/Scripts/refs/heads/main/main.luau" },
              { Name = "gravity hub", ImageId = "rbxassetid://125195601221377", Url = "https://raw.githubusercontent.com/Dev-GravityHub/BloxFruit/refs/heads/main/Main.lua" },
              { Name = "Solix Hub", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/debunked69/Solixreworkkeysystem/refs/heads/main/solix%20new%20keyui.lua" },
              { Name = "teddy hub", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/Teddyseetink/Haidepzai/refs/heads/main/TeddyHub.lua" },
              { Name = "Blue X hub", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/Dev-BlueX/BlueX-Hub/refs/heads/main/Main.lua" },
              { Name = "Xeter v3", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/TlDinhKhoi/Xeter/refs/heads/main/Main.lua" },
              { Name = "Hoho Hub", ImageId = "rbxassetid://108969730921354", Url = "https://raw.githubusercontent.com/acsu123/HOHO_H/main/Loading_UI" }, 
              { Name = "min gaming", ImageId = "rbxassetid://108969730921354", Url = "https://pastebin.com/raw/gteQm30R" }
          }
      },
      {
          Name = "Natural Disaster",
          ImageId = "rbxassetid://95718652005850",
          PlaceIds = {189707},
          Scripts = {
              { Name = "NDS Script", ImageId = "rbxassetid://96215142542691", Url = "https://rawscripts.net/raw/Natural-Disaster-Survival-NullFire-NDS-24033" },
              { Name = "I Was Here", ImageId = "rbxassetid://96215142542691", Url = "https://rawscripts.net/raw/Natural-Disaster-Survival-I-was-here-3355" }
          }
      },
      {
          Name = "Westbound",
          ImageId = "rbxassetid://73451956078956",
          PlaceIds = {2474168535},
          Scripts = {
              { Name = "Speed & Aimbot", ImageId = "rbxassetid://96215142542691", Url = "https://rawscripts.net/raw/Westbound-Speed-and-Aimbot-and-ESP-and-Teleports-and-More-6503" },
              { Name = "Westbound Pro", ImageId = "rbxassetid://96215142542691", Url = "https://rawscripts.net/raw/Westbound-pro-7125" }
          }
      },
      {
          Name = "build a boat",
          ImageId = "rbxassetid://103640559940133",
          PlaceIds = {537413528},
          Scripts = {
              { Name = "BABFT", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/TheRealAsu/BABFT/refs/heads/main/Loader.lua" },
              { Name = "Solix ", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/debunked69/solixloader/refs/heads/main/solix%20v2%20new%20loader.lua" }, 
         { Name = "orbitsc ", ImageId = "rbxassetid://96215142542691", Url = "https://orbitsc.net/babft" }
          }
      },
      {
          Name = "Blade Ball",
          ImageId = "rbxassetid://139314738900642",
          PlaceIds = {13772394625, 16281300371},
          Scripts = {
              { Name = "Auto Parry", ImageId = "rbxassetid://96215142542691", Url = "https://rawscripts.net/raw/UPD-Blade-Ball-Drop-Farm-10716" },
              { Name = "Blade Ball Hub", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/FFJ1/Roblox-Exploits/main/scripts/BladeBall.lua" }
          }
      },
      {
          Name = "grow a garden",
          ImageId = "rbxassetid://70582874678987",
          PlaceIds = {13772394625},
          Scripts = {
              { Name = "kurd hub", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/Ninja10908/S4/refs/heads/main/Kurdhub" },
              { Name = "Xenithub", ImageId = "rbxassetid://96215142542691", Url = "https://api.luarmor.net/files/v4/loaders/d7be76c234d46ce6770101fded39760c.lua" }
          }
      },
      {
        Name = "rivals",
          ImageId = "rbxassetid://104957864940196",
          PlaceIds = {13772394625},
          Scripts = {
              { Name = "duck hub", ImageId = "rbxassetid://104957864940196", Url = "https://raw.githubusercontent.com/HexFG/duckhub/refs/heads/main/loader.lua" },
              { Name = "kiciahook", ImageId = "rbxassetid://104957864940196", Url = "https://raw.githubusercontent.com/kiciahook/kiciahook/refs/heads/main/loader.lua" }
          }
      },
      {
          Name = "Evade",
          ImageId = "rbxassetid://108028543174688",
          PlaceIds = {9872472334},
          Scripts = {
              { Name = "Evade GUI", ImageId = "rbxassetid://96215142542691", Url = "https://rawscripts.net/raw/Evade-Evade-The-Best-Free-GUI-Script-lots-of-Features-20718" },
              { Name = "ESP & More", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/GamingScripter/Darkrai-X/main/Games/Evade" }
          }
      },
      {
          Name = "Dead Rails",
          ImageId = "rbxassetid://116968716835383",
          PlaceIds = {116495829188952},
          Scripts = {
              { Name = "SpiderX Hub", ImageId = "rbxassetid://116968716835383", Url = "https://rawscripts.net/raw/Dead-Rails-Alpha-New-Update-SpiderXHub-30981" }
          }
      },
      {
          Name = "No JUMPING Obby",
          ImageId = "rbxassetid://124016538119062",
          PlaceIds = {5926583186},
          Scripts = {
              { Name = "Drakthon", ImageId = "rbxassetid://124016538119062", Url = "https://raw.githubusercontent.com/DrakthonHub/Just/refs/heads/main/no%20jumnp.lua.txt" }
          }
      },
      {
          Name = "Project Smash",
          ImageId = "rbxassetid://124643335727712",
          PlaceIds = {16200303170},
          Scripts = {
              { Name = "OP Script", ImageId = "rbxassetid://96215142542691", Url = "https://rawscripts.net/raw/Project-Smash-OP-SCRIPT-12920" }
          }
      },
      {
          Name = "steal a brainrot",
          ImageId = "rbxassetid://74207933756868",
          PlaceIds = {109983668079237},
          Scripts = {
              { Name = "nexo hub", ImageId = "rbxassetid://74207933756868", Url = "https://raw.githubusercontent.com/hassanxzayn-lua/NEOXHUBMAIN/refs/heads/main/StealABrainrot"}, 
              { Name = "OP script", ImageId = "rbxassetid://74207933756868", Url = "https://raw.githubusercontent.com/tienkhanh1/spicy/main/Chilli.lua"}
          } 
      }, 
      {  
          Name = "time bomb td",
          ImageId = "rbxassetid://134170376076946",
          PlaceIds = {11379739543},
          Scripts = {
              { Name = "nexal hub", ImageId = "rbxassetid://134170376076946", Url = "https://raw.githubusercontent.com/Naifalhbob/Nexal-Hub/refs/heads/main/Langui.lua"}, 
                { Name = "front evil", ImageId = "rbxassetid://134170376076946", Url = "https://raw.githubusercontent.com/Front-Evill/Script-Hub/refs/heads/main/TiemBomb.V1.lua"}, 
                  { Name = "7ydy", ImageId = "rbxassetid://134170376076946", Url = "https://raw.githubusercontent.com/7yd7/Hub/refs/heads/Branch/Terms-of-Service.lua"}, 
                    { Name = "01iq", ImageId = "rbxassetid://134170376076946", Url = "https://raw.githubusercontent.com/01iq/scripthub/refs/heads/main/solara"}
          } 
      }, 
      {  
          Name = "ragdoll engine",
          ImageId = "rbxassetid://130272762184818",
          PlaceIds = {5683833663, 6165420832}, 
          Scripts = {
              { Name = "SystemBroken", ImageId = "rbxassetid://130272762184818", Url = "https://raw.githubusercontent.com/H20CalibreYT/SystemBroken/main/script"}
          }
      },
      {
          Name = "slap Battle",
          ImageId = "rbxassetid://92199338551980",
          PlaceIds = {6403373529},
          Scripts = {
              { Name = "OP script", ImageId = "rbxassetid://92199338551980", Url = "https://raw.githubusercontent.com/vinqDevelops/erwwefqweqewqwe/refs/heads/main/lol.txt"}, 
              { Name = "forge hub", ImageId = "rbxassetid://92199338551980", Url = "https://raw.githubusercontent.com/Skzuppy/forge-hub/main/loader.lua"}
          }
      },
      {
          Name = "Blue Lock Rivals",
          ImageId = "rbxassetid://128401043164619",
          PlaceIds = {115110570222234, 18668065416},
          Scripts = {
              { Name = "Rat Hub", ImageId = "rbxassetid://96215142542691", Url = "https://rawscripts.net/raw/UPD-Blue-Lock:-Rivals-Rat-Hub-7-UNDETECTED-FREE-STYLE-CHANGER-AND-FLOW-NO-KEY-7-31266" },
              { Name = "Blue Lock Key", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/selciawashere/screepts/refs/heads/main/BLRTBDKEYSYS" },
            { Name = "control ball", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/RedJDark/CONTROL-SCRIPTT/refs/heads/main/CONTROL" },
              { Name = "Don Lorenzo", ImageId = "rbxassetid://96215142542691", Url = "https://rawscripts.net/raw/UPD-Blue-Lock:-Rivals-Good-script-for-new-update-free-Don-Lorenzo-30729" },
              { Name = "NS Hub", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/OhhMyGehlee/fo/refs/heads/main/ot" }
          }
      },
      {
          Name = "Fisch",
          ImageId = "rbxassetid://95961551635994",
          PlaceIds = {16732694052},
          Scripts = {
              { Name = "MOBY Vixie", ImageId = "rbxassetid://96215142542691", Url = "https://rawscripts.net/raw/Fisch-MOBY-Vixie-BEST-OP-AUTO-FISCH-KEYLESS-AND-FREE-30739" },
              { Name = "Auto Farm", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/AhmadV99/Speed-Hub-X/main/Speed%20Hub%20X.lua" }
          }
      },
      {
          Name = "Murder Mystery 2",
          ImageId = "rbxassetid://99780567165855",
          PlaceIds = {142823291},
          Scripts = {
              { Name = "Oblivion AUTO", ImageId = "rbxassetid://96215142542691", Url = "https://rawscripts.net/raw/Universal-Script-Oblivion-AUTO-EXE-V1-6063" },
              { Name = "Eclipse Hub", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/Ethanoj1/EclipseMM2/master/Script" },
              { Name = "Vynixius", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/RegularVynixu/Vynixius/main/Loader.lua" }
          }
      },
      {
          Name = "Brookhaven",
          ImageId = "rbxassetid://80685275474970",
          PlaceIds = {4924922222},
          Scripts = {
              { Name = "Brookhaven RP", ImageId = "rbxassetid://96215142542691", Url = "https://rawscripts.net/raw/Brookhaven-RP-lraq-31077" },
              { Name = "S7 Hub", ImageId = "rbxassetid://96215142542691", Url = "https://rawscripts.net/raw/Brookhaven-RP-S7-hub-30753" },
              { Name = "Ice Hub", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/IceMael7/NewIceHub/main/Brookhaven" }
          }
      },
      {
          Name = "Be a Car",
          ImageId = "rbxassetid://75727695543986",
          PlaceIds = {107326628277908},
          Scripts = {
              { Name = "Inf Cash Farm", ImageId = "rbxassetid://75727695543986", Url = "https://rawscripts.net/raw/Be-a-Car-Inf-Csh-Frm-31206" }
          }
      },
      {
          Name = "Plants vs Brainrots",
          ImageId = "rbxassetid://110492691944186",
          PlaceIds = {127742093697776},
          Scripts = {
              { Name = "Blessed Hub X", ImageId = "rbxassetid://96784815132271", Url = "https://raw.githubusercontent.com/mynamewendel-ctrl/Blessed-Hub-X-/refs/heads/main/Plants-Vs-Brainrots.lua" }, 
              { Name = "Anonymous hub", ImageId = "rbxassetid://110492691944186", Url = "https://raw.githubusercontent.com/HitAMassy/AnonymousHub/refs/heads/main/loader.lua" }
          }
      },
      {
          Name = "i wanna test the game",
          ImageId = "rbxassetid://72286179141217",
          PlaceIds = {1},
          Scripts = {
              { Name = "Auto win", ImageId = "rbxassetid://72286179141217", Url = "https://raw.githubusercontent.com/Ginxys/I-Wanna-Test-The-Game/main/Script.Lua" }
         
          }
      },
       {
          Name = "no jumping obby",
          ImageId = "rbxassetid://124016538119062",
          PlaceIds = {5926583186},
          Scripts = {
              { Name = "Drakthon", ImageId = "rbxassetid://124016538119062", Url = "https://raw.githubusercontent.com/DrakthonHub/Just/refs/heads/main/no%20jumnp.lua.txt" }
         
          }
      },
       {
          Name = "night 99",
          ImageId = "rbxassetid://127321044133965",
          PlaceIds = {7326934954},
          Scripts = {
              { Name = "Moon", ImageId = "rbxassetid://127321044133965", Url = "https://raw.githubusercontent.com/m00ndiety/99-nights-in-the-forest/refs/heads/main/Main" },
          { Name = "script", ImageId = "rbxassetid://127321044133965", Url = "https://raw.githubusercontent.com/OverflowBGSI/Overflow/refs/heads/main/loader.txt" }
          }
      },
      {
          Name = "Fling Things and People",
          ImageId = "rbxassetid://123164598988796",
          PlaceIds = {6961824067},
          Scripts = {
              { Name = "Blitz FTAP", ImageId = "rbxassetid://96215142542691", Url = "https://rawscripts.net/raw/Fling-Things-and-People-Blitz-FTAP-Free-Premium-UPDATED-29690" }
          }
      },
      {
          Name = "Find The Button [150]",
          ImageId = "rbxassetid://106219678352107",
          PlaceIds = {103593441753340, 82775216869079},
          Scripts = {
              { Name = "Auto Finish", ImageId = "rbxassetid://96215142542691", Url = "https://rawscripts.net/raw/Find-The-Button!-esp-button-and-auto-finish-lv-27417" }
          }
      },
      {
          Name = "Arsenal",
          ImageId = "rbxassetid://120484146915674",
          PlaceIds = {286090429},
          Scripts = {
              { Name = "Owl Hub", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/CriShoux/OwlHub/master/OwlHub.txt" },
              { Name = "DarkHub", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/RandomAdamYT/DarkHub/master/Init" }
          }
      },
      {
          Name = "The Strongest Battlegrounds",
          ImageId = "rbxassetid://137794802628641",
          PlaceIds = {101251546910222,10449761463},
          Scripts = {
              { Name = "roli hub", ImageId = "rbxassetid://137794802628641", Url = "https://rawscripts.net/raw/Universal-Script-ROLL-HUB-70029" },
              { Name = "VEXON HUB", ImageId = "rbxassetid://137794802628641", Url = "https://raw.githubusercontent.com/DiosDi/VexonHub/refs/heads/main/VexonHub" }
          }
      },
      {
          Name = "Pet Simulator X",
          ImageId = "rbxassetid://95355891650173",
          PlaceIds = {6284583030},
          Scripts = {
              { Name = "Jmes Hub", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/jmesfo0/RobloxScripts/main/psx-jmes.lua" },
              { Name = "Project WD", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/Muhammad6196/Project-WD/main/Main.lua" }
          }
      },
      {
          Name = "Doors",
          ImageId = "rbxassetid://118043704976810",
          PlaceIds = {6516141723},
          Scripts = {
              { Name = "Vynixius Doors", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/RegularVynixu/Vynixius/main/Doors/Script.lua" },
              { Name = "Doors Hub", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/KINGHUB01/BlackKing-obf/main/Doors" }
          }
      },
      {
          Name = "Jailbreak",
          ImageId = "rbxassetid://132815215149076",
          PlaceIds = {606849621},
          Scripts = {
              { Name = "Vynixius JB", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/RegularVynixu/Scripts/master/Vynixius/Jailbreak" },
              { Name = "Auto Rob", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/wawsdasdacx/ohascriptnrrewading/main/jbsaxcriptidk1" }
          }
      },
      {
          Name = "Adopt Me",
          ImageId = "rbxassetid://90879994463670",
          PlaceIds = {920587237},
          Scripts = {
              { Name = "Adopt Me Hub", ImageId = "rbxassetid://96215142542691", Url = "https://raw.githubusercontent.com/IceMael7/NewIceHub/main/IceHub" },
              { Name = "Auto Farm", ImageId = "rbxassetid://96215142542691", Url = "https://pastebin.com/raw/MwpFJQ3H" }
          }
      },
      {
          Name = "Tower of Hell",
          ImageId = "rbxassetid://118359328908614",
          PlaceIds = {1962086868},
          Scripts = {
              { Name = "TOH Hub", ImageId = "rbxassetid://118359328908614", Url = "https://raw.githubusercontent.com/2dgeneralspam1/scripts-and-stuff/master/scripts/LoadstringypVvhJBq4QNz" },
              { Name = "Infinite Jump", ImageId = "rbxassetid://118359328908614", Url = "https://pastebin.com/raw/0wYkMfE5" }
          }
      },
      {
          Name = "King Legacy",
          ImageId = "rbxassetid://90377523209869",
          PlaceIds = {4520749081},
          Scripts = {
              { Name = "Strike Hub", ImageId = "rbxassetid://90377523209869", Url = "https://raw.githubusercontent.com/StormSKz12/StirkeHub1/main/Gameincluded" },
              { Name = "Auto Quest", ImageId = "rbxassetid://90377523209869", Url = "https://raw.githubusercontent.com/hajibeza/RIPPER-HUB/main/King%20Legacy" }
          }
      },
      {
          Name = "Da Hood",
          ImageId = "rbxassetid://112115338019626",
          PlaceIds = {2788229376},
          Scripts = {
              { Name = "Swag Mode", ImageId = "rbxassetid://112115338019626", Url = "https://raw.githubusercontent.com/lerkermer/lua-projects/master/SwagModeV002" },
              { Name = "Arctic Hub", ImageId = "rbxassetid://112115338019626", Url = "https://raw.githubusercontent.com/PolarWasHere/Arctic/main/Arctic" }
        }
    },
    {
        Name = "Blade Ball",
        ImageId = "rbxassetid://139314738900642",
        PlaceIds = {13772394625, 14732108409},
        Scripts = {
            { 
                Name = "Auto Parry", 
                ImageId = "rbxassetid://96215142542691", 
                Url = "https://rawscripts.net/raw/UPD-Blade-Ball-Drop-Farm-10716" 
            }
        }
    }
}

local currentScripts = {}
local mapCards = {}
local menuOpen = false

local function createTooltipForElement(element, text)
    local pressing = false
    local pressTimer = nil
    
    element.MouseEnter:Connect(function()
        pressing = true
        pressTimer = task.delay(Config.TooltipDelay, function()
            if pressing then
                local mousePos = UserInputService:GetMouseLocation()
                showTooltip(text, mousePos)
            end
        end)
    end)
    
    element.MouseLeave:Connect(function()
        pressing = false
        if pressTimer then
            task.cancel(pressTimer)
        end
        hideTooltip()
    end)
end

local function createMapCard(mapData)
    local card = Instance.new("TextButton")
    card.Name = mapData.Name
    card.Text = ""
    card.BackgroundColor3 = Config.ButtonColor
    card.BorderSizePixel = 0
    card.Size = UDim2.new(1, 0, 0, 90)
    card.BackgroundTransparency = 1
    
    local cardCorner = Instance.new("UICorner")
    cardCorner.CornerRadius = UDim.new(0, 12)
    cardCorner.Parent = card
    
    local image = Instance.new("ImageLabel")
    image.Size = UDim2.new(0, 70, 0, 70)
    image.Position = UDim2.new(0, 10, 0.5, -35)
    image.Image = mapData.ImageId
    image.BackgroundTransparency = 1
    image.Parent = card
    
    local imgCorner = Instance.new("UICorner")
    imgCorner.CornerRadius = UDim.new(0, 8)
    imgCorner.Parent = image
    
    local label = Instance.new("TextLabel")
    label.Text = mapData.Name
    label.Font = Enum.Font.GothamBold
    label.TextSize = 16
    label.TextColor3 = Config.AccentColor
    label.BackgroundTransparency = 1
    label.Size = UDim2.new(0.6, 0, 0.5, 0)
    label.Position = UDim2.new(0, 90, 0.25, 0)
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = card
    
    createTooltipForElement(card, mapData.Name)
    
    card.MouseButton1Click:Connect(function()
        playSound(Sounds.Click)
        
        for _, child in pairs(ScriptsPanel:GetChildren()) do
            if child:IsA("Frame") then
                child:Destroy()
            end
        end
        
        currentScripts = mapData.Scripts
        
        for i, scriptData in pairs(mapData.Scripts) do
            task.wait(0.03)
            
            local scriptCard = Instance.new("Frame")
            scriptCard.BackgroundColor3 = Config.ButtonColor
            scriptCard.BorderSizePixel = 0
            scriptCard.Size = UDim2.new(1, 0, 0, 85)
            scriptCard.BackgroundTransparency = 1
            scriptCard.Parent = ScriptsPanel
            
            local scriptCorner = Instance.new("UICorner")
            scriptCorner.CornerRadius = UDim.new(0, 12)
            scriptCorner.Parent = scriptCard
            
            local scriptImage = Instance.new("ImageLabel")
            scriptImage.Size = UDim2.new(0, 65, 0, 65)
            scriptImage.Position = UDim2.new(0, 10, 0.5, -32.5)
            scriptImage.Image = scriptData.ImageId
            scriptImage.BackgroundTransparency = 1
            scriptImage.Parent = scriptCard
            
            local scriptImgCorner = Instance.new("UICorner")
            scriptImgCorner.CornerRadius = UDim.new(0, 8)
            scriptImgCorner.Parent = scriptImage
            
            local scriptLabel = Instance.new("TextLabel")
            scriptLabel.Text = scriptData.Name
            scriptLabel.Font = Enum.Font.GothamBold
            scriptLabel.TextSize = 15
            scriptLabel.TextColor3 = Config.AccentColor
            scriptLabel.BackgroundTransparency = 1
            scriptLabel.Size = UDim2.new(0.45, 0, 0.5, 0)
            scriptLabel.Position = UDim2.new(0, 85, 0.25, 0)
            scriptLabel.TextXAlignment = Enum.TextXAlignment.Left
            scriptLabel.TextTruncate = Enum.TextTruncate.AtEnd
            scriptLabel.Parent = scriptCard
            
            createTooltipForElement(scriptCard, scriptData.Name)
            
            local runButton = Instance.new("TextButton")
            runButton.Text = "RUN"
            runButton.Font = Enum.Font.GothamBold
            runButton.TextSize = 14
            runButton.TextColor3 = Config.SecondaryColor
            runButton.BackgroundColor3 = Config.AccentColor
            runButton.Size = UDim2.new(0, 75, 0, 65)
            runButton.Position = UDim2.new(1, -85, 0.5, -32.5)
            runButton.Parent = scriptCard
            
            local runCorner = Instance.new("UICorner")
            runCorner.CornerRadius = UDim.new(0, 10)
            runCorner.Parent = runButton
            
            runButton.MouseButton1Click:Connect(function()
                playSound(Sounds.Click)
                createNotification("Loading", "Executing " .. scriptData.Name, "info")
                
                task.spawn(function()
                    local success, err = pcall(function()
                        loadstring(game:HttpGet(scriptData.Url, true))()
                    end)
                    
                    if success then
                        createNotification("Success", scriptData.Name .. " loaded", "success")
                    else
                        warn("[Drakthon] Error:", err)
                        createNotification("Error", "Failed to load script", "error")
                    end
                end)
            end)
            
            TweenService:Create(scriptCard,
                TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out),
                {BackgroundTransparency = 0}
            ):Play()
        end
    end)
    
    card.MouseEnter:Connect(function()
        TweenService:Create(card,
            TweenInfo.new(0.2, Enum.EasingStyle.Quad),
            {BackgroundColor3 = Config.HoverColor}
        ):Play()
    end)
    
    card.MouseLeave:Connect(function()
        TweenService:Create(card,
            TweenInfo.new(0.2, Enum.EasingStyle.Quad),
            {BackgroundColor3 = Config.ButtonColor}
        ):Play()
    end)
    
    mapCards[mapData.Name] = card
    return card
end

for i, mapData in ipairs(Maps) do
    local card = createMapCard(mapData)
    card.Parent = MapsPanel
    
    task.wait(0.04)
    TweenService:Create(card,
        TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out),
        {BackgroundTransparency = 0}
    ):Play()
end

-- SCRIPTBLOX SYSTEM
local currentPage = 1
local scriptsPerPage = 15
local allScripts = {}
local isLoadingScripts = false
local loadedPages = {}

local function loadScriptBloxScripts(searchQuery)
    if isLoadingScripts then return end
    
    isLoadingScripts = true
    currentPage = 1
    allScripts = {}
    loadedPages = {}
    
    for _, child in pairs(ScriptBloxScroll:GetChildren()) do
        if child:IsA("Frame") then
            child:Destroy()
        end
    end
    
    local LoadingFrame = Instance.new("Frame")
    LoadingFrame.Name = "LoadingIndicator"
    LoadingFrame.Size = UDim2.new(1, 0, 0, 60)
    LoadingFrame.BackgroundColor3 = Config.ButtonColor
    LoadingFrame.BorderSizePixel = 0
    LoadingFrame.Parent = ScriptBloxScroll
    
    local LoadingCorner = Instance.new("UICorner")
    LoadingCorner.CornerRadius = UDim.new(0, 12)
    LoadingCorner.Parent = LoadingFrame
    
    local LoadingText = Instance.new("TextLabel")
    LoadingText.Text = searchQuery == "" and "Loading trending scripts..." or "Searching..."
    LoadingText.Font = Enum.Font.GothamBold
    LoadingText.TextSize = 16
    LoadingText.TextColor3 = Config.AccentColor
    LoadingText.BackgroundTransparency = 1
    LoadingText.Size = UDim2.new(1, 0, 1, 0)
    LoadingText.Parent = LoadingFrame
    
    ScriptBloxTitle.Text = searchQuery == "" and "TRENDING SCRIPTS" or "SEARCH RESULTS"
    
    local url = "https://scriptblox.com/api/script/search?q=" .. HttpService:UrlEncode(searchQuery) .. "&max=60&mode=free"
    
    task.spawn(function()
        local success, response = pcall(function()
            return game:HttpGet(url, true)
        end)
        
        LoadingFrame:Destroy()
        
        if success and response then
            local parseSuccess, data = pcall(function()
                return HttpService:JSONDecode(response)
            end)
            
            if parseSuccess and data and data.result and data.result.scripts then
                allScripts = data.result.scripts
                
                if #allScripts == 0 then
                    local NoResultsFrame = Instance.new("Frame")
                    NoResultsFrame.Size = UDim2.new(1, 0, 0, 100)
                    NoResultsFrame.BackgroundColor3 = Config.ButtonColor
                    NoResultsFrame.BorderSizePixel = 0
                    NoResultsFrame.Parent = ScriptBloxScroll
                    
                    local NoResultsCorner = Instance.new("UICorner")
                    NoResultsCorner.CornerRadius = UDim.new(0, 12)
                    NoResultsCorner.Parent = NoResultsFrame
                    
                    local NoResultsText = Instance.new("TextLabel")
                    NoResultsText.Text = "No scripts found\n\nTry a different search term"
                    NoResultsText.Font = Enum.Font.GothamBold
                    NoResultsText.TextSize = 15
                    NoResultsText.TextColor3 = Config.SubTextColor
                    NoResultsText.BackgroundTransparency = 1
                    NoResultsText.Size = UDim2.new(1, 0, 1, 0)
                    NoResultsText.Parent = NoResultsFrame
                    
                    isLoadingScripts = false
                    return
                end
                
                local function loadPage(page)
                    if loadedPages[page] then return end
                    loadedPages[page] = true
                    
                    local startIndex = (page - 1) * scriptsPerPage + 1
                    local endIndex = math.min(startIndex + scriptsPerPage - 1, #allScripts)
                    
                    for i = startIndex, endIndex do
                        local script = allScripts[i]
                        if not script then continue end
                        
                        task.wait(0.02)
                        
                        local scriptCard = Instance.new("Frame")
                        scriptCard.BackgroundColor3 = Config.ButtonColor
                        scriptCard.BorderSizePixel = 0
                        scriptCard.Size = UDim2.new(1, 0, 0, 115)
                        scriptCard.BackgroundTransparency = 1
                        scriptCard.LayoutOrder = i
                        scriptCard.Parent = ScriptBloxScroll
                        
                        local scriptCorner = Instance.new("UICorner")
                        scriptCorner.CornerRadius = UDim.new(0, 12)
                        scriptCorner.Parent = scriptCard
                        
                        local scriptImage = Instance.new("ImageLabel")
                        scriptImage.Size = UDim2.new(0, 95, 0, 95)
                        scriptImage.Position = UDim2.new(0, 10, 0.5, -47.5)
                        scriptImage.BackgroundColor3 = Config.SecondaryColor
                        scriptImage.BorderSizePixel = 0
                        scriptImage.Image = Config.DefaultImage
                        scriptImage.Parent = scriptCard
                        
                        task.spawn(function()
                            local imageUrl = nil
                            
                            if script.game and type(script.game) == "table" and script.game.imageUrl and script.game.imageUrl ~= "" then
                                imageUrl = script.game.imageUrl
                            elseif script.thumbnail and script.thumbnail ~= "" then
                                imageUrl = "https://scriptblox.com" .. script.thumbnail
                            elseif script.game and type(script.game) == "table" and script.game.image and script.game.image ~= "" then
                                imageUrl = "https://scriptblox.com" .. script.game.image
                            elseif script.image and type(script.image) == "string" and script.image ~= "" then
                                imageUrl = "https://scriptblox.com" .. script.image
                            end
                            
                            if imageUrl and imageUrl ~= "" then
                                task.wait(0.1)
                                local loadedAsset = LoadCustomImage(imageUrl, script._id or ("sb_" .. i))
                                if loadedAsset and loadedAsset ~= Config.DefaultImage then
                                    scriptImage.Image = loadedAsset
                                end
                            end
                        end)
                        
                        local scriptImgCorner = Instance.new("UICorner")
                        scriptImgCorner.CornerRadius = UDim.new(0, 8)
                        scriptImgCorner.Parent = scriptImage
                        
                        local titleLabel = Instance.new("TextLabel")
                        titleLabel.Text = script.title or "Unknown Script"
                        titleLabel.Font = Enum.Font.GothamBold
                        titleLabel.TextSize = 14
                        titleLabel.TextColor3 = Config.AccentColor
                        titleLabel.BackgroundTransparency = 1
                        titleLabel.Size = UDim2.new(0.42, 0, 0.2, 0)
                        titleLabel.Position = UDim2.new(0, 115, 0, 5)
                        titleLabel.TextXAlignment = Enum.TextXAlignment.Left
                        titleLabel.TextTruncate = Enum.TextTruncate.AtEnd
                        titleLabel.Parent = scriptCard
                        
                        local gameLabel = Instance.new("TextLabel")
                        local gameName = "Universal"
                        if script.game and type(script.game) == "table" and script.game.name then
                            gameName = script.game.name
                        end
                        gameLabel.Text = gameName
                        gameLabel.Font = Enum.Font.Gotham
                        gameLabel.TextSize = 12
                        gameLabel.TextColor3 = Config.SubTextColor
                        gameLabel.BackgroundTransparency = 1
                        gameLabel.Size = UDim2.new(0.42, 0, 0.18, 0)
                        gameLabel.Position = UDim2.new(0, 115, 0.23, 0)
                        gameLabel.TextXAlignment = Enum.TextXAlignment.Left
                        gameLabel.TextTruncate = Enum.TextTruncate.AtEnd
                        gameLabel.Parent = scriptCard
                        
                        local statsContainer = Instance.new("Frame")
                        statsContainer.BackgroundTransparency = 1
                        statsContainer.Size = UDim2.new(0.42, 0, 0.4, 0)
                        statsContainer.Position = UDim2.new(0, 115, 0.5, 0)
                        statsContainer.Parent = scriptCard
                        
                        local verifiedColor = script.verified and Color3.fromRGB(100, 255, 100) or Color3.fromRGB(255, 200, 100)
                        
                        local verifiedLabel = Instance.new("TextLabel")
                        verifiedLabel.Text = script.verified and "Verified" or "Unverified"
                        verifiedLabel.Font = Enum.Font.GothamBold
                        verifiedLabel.TextSize = 11
                        verifiedLabel.TextColor3 = verifiedColor
                        verifiedLabel.BackgroundTransparency = 1
                        verifiedLabel.Size = UDim2.new(1, 0, 0.33, 0)
                        verifiedLabel.TextXAlignment = Enum.TextXAlignment.Left
                        verifiedLabel.Parent = statsContainer
                        
                        local viewsLabel = Instance.new("TextLabel")
                        viewsLabel.Text = "Views: " .. tostring(script.views or 0)
                        viewsLabel.Font = Enum.Font.Gotham
                        viewsLabel.TextSize = 11
                        viewsLabel.TextColor3 = Config.SubTextColor
                        viewsLabel.BackgroundTransparency = 1
                        viewsLabel.Size = UDim2.new(1, 0, 0.33, 0)
                        viewsLabel.Position = UDim2.new(0, 0, 0.33, 0)
                        viewsLabel.TextXAlignment = Enum.TextXAlignment.Left
                        viewsLabel.Parent = statsContainer
                        
                        local dateLabel = Instance.new("TextLabel")
                        if script.createdAt then
                            local timestamp = DateTime.fromIsoDate(script.createdAt)
                            if timestamp then
                                local now = DateTime.now().UnixTimestamp
                                local diff = now - timestamp.UnixTimestamp
                                local days = math.floor(diff / 86400)
                                dateLabel.Text = "Date: " .. (days == 0 and "Today" or days .. "d ago")
                            else
                                dateLabel.Text = "Date: Unknown"
                            end
                        else
                            dateLabel.Text = "Date: Unknown"
                        end
                        dateLabel.Font = Enum.Font.Gotham
                        dateLabel.TextSize = 11
                        dateLabel.TextColor3 = Config.SubTextColor
                        dateLabel.BackgroundTransparency = 1
                        dateLabel.Size = UDim2.new(1, 0, 0.33, 0)
                        dateLabel.Position = UDim2.new(0, 0, 0.66, 0)
                        dateLabel.TextXAlignment = Enum.TextXAlignment.Left
                        dateLabel.Parent = statsContainer
                        
                        createTooltipForElement(scriptCard, (script.title or "Unknown") .. " - " .. gameName)
                        
                        local runButton = Instance.new("TextButton")
                        runButton.Text = "RUN"
                        runButton.Font = Enum.Font.GothamBold
                        runButton.TextSize = 15
                        runButton.TextColor3 = Config.SecondaryColor
                        runButton.BackgroundColor3 = Config.AccentColor
                        runButton.Size = UDim2.new(0, 85, 0, 95)
                        runButton.Position = UDim2.new(1, -95, 0.5, -47.5)
                        runButton.Parent = scriptCard
                        
                        local runCorner = Instance.new("UICorner")
                        runCorner.CornerRadius = UDim.new(0, 10)
                        runCorner.Parent = runButton
                        
                        runButton.MouseEnter:Connect(function()
                            TweenService:Create(runButton,
                                TweenInfo.new(0.2, Enum.EasingStyle.Quad),
                                {BackgroundColor3 = Color3.fromRGB(200, 200, 200), Size = UDim2.new(0, 90, 0, 100)}
                            ):Play()
                        end)
                        
                        runButton.MouseLeave:Connect(function()
                            TweenService:Create(runButton,
                                TweenInfo.new(0.2, Enum.EasingStyle.Quad),
                                {BackgroundColor3 = Config.AccentColor, Size = UDim2.new(0, 85, 0, 95)}
                            ):Play()
                        end)
                        
                        runButton.MouseButton1Click:Connect(function()
                            playSound(Sounds.Click)
                            createNotification("Loading", "Fetching " .. (script.title or "script"), "info")
                            
                            runButton.Text = "..."
                            runButton.TextSize = 20
                            
                            task.spawn(function()
                                local scriptSuccess, scriptData = pcall(function()
                                    return game:HttpGet("https://scriptblox.com/api/script/" .. (script.slug or script._id), true)
                                end)
                                
                                if scriptSuccess and scriptData then
                                    local scriptParseSuccess, scriptInfo = pcall(function()
                                        return HttpService:JSONDecode(scriptData)
                                    end)
                                    
                                    if scriptParseSuccess and scriptInfo and scriptInfo.script and scriptInfo.script.script then
                                        local execSuccess, execErr = pcall(function()
                                            loadstring(scriptInfo.script.script)()
                                        end)
                                        
                                        if execSuccess then
                                            createNotification("Success", (script.title or "Script") .. " executed", "success")
                                            runButton.Text = "OK"
                                            runButton.BackgroundColor3 = Color3.fromRGB(100, 255, 100)
                                            task.wait(2)
                                            runButton.Text = "RUN"
                                            runButton.TextSize = 15
                                            runButton.BackgroundColor3 = Config.AccentColor
                                        else
                                            warn("[Drakthon] Execution error:", execErr)
                                            createNotification("Error", "Script execution failed", "error")
                                            runButton.Text = "ERR"
                                            runButton.BackgroundColor3 = Color3.fromRGB(255, 100, 100)
                                            task.wait(2)
                                            runButton.Text = "RUN"
                                            runButton.TextSize = 15
                                            runButton.BackgroundColor3 = Config.AccentColor
                                        end
                                    else
                                        createNotification("Error", "Invalid script data", "error")
                                        runButton.Text = "RUN"
                                        runButton.TextSize = 15
                                    end
                                else
                                    createNotification("Error", "Failed to fetch script", "error")
                                    runButton.Text = "RUN"
                                    runButton.TextSize = 15
                                end
                            end)
                        end)
                        
                        TweenService:Create(scriptCard,
                            TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
                            {BackgroundTransparency = 0}
                        ):Play()
                    end
                end
                
                loadPage(1)
                
                local scrollConnection
                scrollConnection = ScriptBloxScroll:GetPropertyChangedSignal("CanvasPosition"):Connect(function()
                    if not isLoadingScripts then return end
                    
                    if ScriptBloxScroll.AbsoluteCanvasSize.Y > ScriptBloxScroll.AbsoluteWindowSize.Y then
                        local scrollPercentage = ScriptBloxScroll.CanvasPosition.Y / 
                            (ScriptBloxScroll.AbsoluteCanvasSize.Y - ScriptBloxScroll.AbsoluteWindowSize.Y)
                        
                        if scrollPercentage > 0.7 then
                            local nextPage = currentPage + 1
                            local startIndex = (nextPage - 1) * scriptsPerPage + 1
                            
                            if startIndex <= #allScripts and not loadedPages[nextPage] then
                                currentPage = nextPage
                                loadPage(currentPage)
                            end
                        end
                    end
                end)
            else
                createNotification("Error", "Failed to parse scripts", "error")
            end
        else
            createNotification("Error", "Connection failed", "error")
        end
        
        isLoadingScripts = false
    end)
end

-- MINIMIZE/RESTORE
local function minimizeHub()
    playSound(Sounds.Close)
    
    TweenService:Create(MainFrame, 
        TweenInfo.new(Config.AnimationSpeed, Enum.EasingStyle.Quint, Enum.EasingDirection.In), 
        {Size = UDim2.new(0, 0, 0, 0)}
    ):Play()
    
    task.wait(Config.AnimationSpeed)
    MainFrame.Visible = false
    MinimizedIcon.Visible = true
    
    MinimizedIcon.Size = UDim2.new(0, 0, 0, 0)
    TweenService:Create(MinimizedIcon,
        TweenInfo.new(Config.AnimationSpeed, Enum.EasingStyle.Back, Enum.EasingDirection.Out),
        {Size = UDim2.new(0, 70, 0, 70)}
    ):Play()
end

local function restoreHub()
    playSound(Sounds.Open)
    
    TweenService:Create(MinimizedIcon,
        TweenInfo.new(Config.AnimationSpeed * 0.6, Enum.EasingStyle.Quint, Enum.EasingDirection.In),
        {Size = UDim2.new(0, 0, 0, 0)}
    ):Play()
    
    task.wait(Config.AnimationSpeed * 0.6)
    MinimizedIcon.Visible = false
    MainFrame.Visible = true
    
    TweenService:Create(MainFrame,
        TweenInfo.new(Config.AnimationSpeed, Enum.EasingStyle.Back, Enum.EasingDirection.Out),
        {Size = getOptimalSize()}
    ):Play()
end

MinimizeButton.MouseButton1Click:Connect(minimizeHub)
MinimizedIcon.MouseButton1Click:Connect(restoreHub)

-- SETTINGS
SettingsButton.MouseButton1Click:Connect(function()
    playSound(Sounds.Click)
    
    local isVisible = SettingsPanel.Visible
    
    TweenService:Create(SettingsIcon,
        TweenInfo.new(Config.AnimationSpeed * 2, Enum.EasingStyle.Linear),
        {Rotation = isVisible and 0 or 360}
    ):Play()
    
    if not isVisible then
        SettingsPanel.Visible = true
        SettingsPanel.Size = UDim2.new(0, 0, 0, 0)
        
        TweenService:Create(SettingsPanel,
            TweenInfo.new(Config.AnimationSpeed, Enum.EasingStyle.Back, Enum.EasingDirection.Out),
            {Size = UDim2.new(0.5, 0, 0.75, 0)}
        ):Play()
    else
        TweenService:Create(SettingsPanel,
            TweenInfo.new(Config.AnimationSpeed, Enum.EasingStyle.Quad, Enum.EasingDirection.In),
            {Size = UDim2.new(0, 0, 0, 0)}
        ):Play()
        
        task.wait(Config.AnimationSpeed)
        SettingsPanel.Visible = false
    end
end)

-- MENU
HamburgerButton.MouseButton1Click:Connect(function()
    playSound(Sounds.Click)
    menuOpen = not menuOpen
    
    local line1Target = menuOpen and {Rotation = 45, Position = UDim2.new(0, 12, 0, 23.5)} or 
                                    {Rotation = 0, Position = UDim2.new(0, 12, 0, 14)}
    local line2Target = menuOpen and {Size = UDim2.new(0, 0, 0, 3), Position = UDim2.new(0, 25, 0, 23.5)} or 
                                    {Size = UDim2.new(0, 26, 0, 3), Position = UDim2.new(0, 12, 0, 23.5)}
    local line3Target = menuOpen and {Rotation = -45, Position = UDim2.new(0, 12, 0, 23.5)} or 
                                    {Rotation = 0, Position = UDim2.new(0, 12, 0, 33)}
    
    TweenService:Create(Line1, TweenInfo.new(Config.AnimationSpeed, Enum.EasingStyle.Quad), line1Target):Play()
    TweenService:Create(Line2, TweenInfo.new(Config.AnimationSpeed, Enum.EasingStyle.Quad), line2Target):Play()
    TweenService:Create(Line3, TweenInfo.new(Config.AnimationSpeed, Enum.EasingStyle.Quad), line3Target):Play()
    
    TweenService:Create(HamburgerMenu,
        TweenInfo.new(Config.AnimationSpeed, Enum.EasingStyle.Quad, 
            menuOpen and Enum.EasingDirection.Out or Enum.EasingDirection.In),
        {Position = menuOpen and UDim2.new(0, 0, 0, 60) or UDim2.new(0, -250, 0, 60)}
    ):Play()
end)

MainMenuButton.MouseButton1Click:Connect(function()
    playSound(Sounds.Click)
    ScriptBloxPanel.Visible = false
    Content.Visible = true
    Footer.Visible = true
end)

ScriptBloxMenuButton.MouseButton1Click:Connect(function()
    playSound(Sounds.Click)
    Content.Visible = false
    Footer.Visible = false
    ScriptBloxPanel.Visible = true
    
    if #allScripts == 0 then
        loadScriptBloxScripts("")
    end
end)

-- SCRIPTBLOX SEARCH
local searchDebounceTimer = nil
ScriptBloxSearch:GetPropertyChangedSignal("Text"):Connect(function()
    if searchDebounceTimer then
        task.cancel(searchDebounceTimer)
    end
    
    searchDebounceTimer = task.delay(1, function()
        local searchText = ScriptBloxSearch.Text:gsub("^%s*(.-)%s*$", "%1")
        loadScriptBloxScripts(searchText)
    end)
end)

-- SOUND TOGGLE
MuteButton.MouseButton1Click:Connect(function()
    Config.SoundEnabled = not Config.SoundEnabled
    SavedSettings.SoundEnabled = Config.SoundEnabled
    saveSettings()
    MuteButton.Text = Config.SoundEnabled and "Sound: ON" or "Sound: OFF"
    
    if Config.SoundEnabled then
        playSound(Sounds.Click)
    end
end)

-- NOTIFICATIONS TOGGLE
NotifButton.MouseButton1Click:Connect(function()
    Config.NotificationsEnabled = not Config.NotificationsEnabled
    SavedSettings.NotificationsEnabled = Config.NotificationsEnabled
    saveSettings()
    NotifButton.Text = Config.NotificationsEnabled and "Notifications: ON" or "Notifications: OFF"
    playSound(Sounds.Click)
end)

-- DISCORD
DiscordButton.MouseButton1Click:Connect(function()
    pcall(function()
        setclipboard("https://discord.gg/W3VwkUj6kf")
    end)
    createNotification("Success", "Discord link copied", "success")
    playSound(Sounds.Copy)
    
    TweenService:Create(DiscordContainer,
        TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
        {Size = UDim2.new(0.92, 0, 0, 62)}
    ):Play()
    
    task.wait(0.1)
    
    TweenService:Create(DiscordContainer,
        TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.In),
        {Size = UDim2.new(0.9, 0, 0, 60)}
    ):Play()
end)

-- CLOSE SETTINGS
CloseSettingsButton.MouseButton1Click:Connect(function()
    playSound(Sounds.Click)
    
    TweenService:Create(SettingsPanel,
        TweenInfo.new(Config.AnimationSpeed, Enum.EasingStyle.Quad, Enum.EasingDirection.In),
        {Size = UDim2.new(0, 0, 0, 0)}
    ):Play()
    
    TweenService:Create(SettingsIcon,
        TweenInfo.new(Config.AnimationSpeed * 2, Enum.EasingStyle.Linear),
        {Rotation = 0}
    ):Play()
    
    task.wait(Config.AnimationSpeed)
    SettingsPanel.Visible = false
end)

-- FEEDBACK SYSTEM
FeedbackButton.MouseButton1Click:Connect(function()
    playSound(Sounds.Click)
    
    if Config.FeedbackCount >= Config.FeedbackLimit then
        createNotification("Limit Reached", "Max " .. Config.FeedbackLimit .. " feedbacks per day", "warning")
        return
    end
    
    local currentTime = tick()
    if currentTime - Config.LastFeedbackTime < Config.FeedbackCooldown then
        local remaining = math.ceil(Config.FeedbackCooldown - (currentTime - Config.LastFeedbackTime))
        createNotification("Cooldown", "Wait " .. remaining .. "s", "warning")
        return
    end
    
    FeedbackWindow.Visible = true
    FeedbackWindow.Size = UDim2.new(0, 0, 0, 0)
    
    TweenService:Create(FeedbackWindow,
        TweenInfo.new(Config.AnimationSpeed, Enum.EasingStyle.Back, Enum.EasingDirection.Out),
        {Size = UDim2.new(0.7, 0, 0.6, 0)}
    ):Play()
end)

FeedbackSendButton.MouseButton1Click:Connect(function()
    local text = FeedbackTextBox.Text:gsub("^%s*(.-)%s*$", "%1")
    
    if #text < 5 then
        createNotification("Invalid", "Feedback must be at least 5 characters", "warning")
        return
    end
    
    local currentTime = tick()
    if currentTime - Config.LastFeedbackTime < Config.FeedbackCooldown then
        local remaining = math.ceil(Config.FeedbackCooldown - (currentTime - Config.LastFeedbackTime))
        createNotification("Cooldown", "Wait " .. remaining .. "s", "warning")
        return
    end
    
    local success = sendFeedback(text)
    
    if success then
        Config.LastFeedbackTime = currentTime
        Config.FeedbackCount = Config.FeedbackCount + 1
        
        playSound(Sounds.Success)
        FeedbackTextBox.Text = ""
        
        TweenService:Create(FeedbackWindow,
            TweenInfo.new(Config.AnimationSpeed, Enum.EasingStyle.Quad, Enum.EasingDirection.In),
            {Size = UDim2.new(0, 0, 0, 0)}
        ):Play()
        
        task.wait(Config.AnimationSpeed)
        FeedbackWindow.Visible = false
        
        createNotification("Success", "Feedback sent! Thank you", "success")
    else
        createNotification("Error", "Failed to send feedback", "error")
    end
end)

FeedbackCloseButton.MouseButton1Click:Connect(function()
    playSound(Sounds.Click)
    
    TweenService:Create(FeedbackWindow,
        TweenInfo.new(Config.AnimationSpeed, Enum.EasingStyle.Quad, Enum.EasingDirection.In),
        {Size = UDim2.new(0, 0, 0, 0)}
    ):Play()
    
    task.wait(Config.AnimationSpeed)
    FeedbackWindow.Visible = false
end)

-- GAME SEARCH
local gameSearchDebounce = nil
SearchBox:GetPropertyChangedSignal("Text"):Connect(function()
    if gameSearchDebounce then
        task.cancel(gameSearchDebounce)
    end
    
    gameSearchDebounce = task.delay(0.3, function()
        local searchText = SearchBox.Text:lower()
        
        for mapName, card in pairs(mapCards) do
            card.Visible = mapName:lower():find(searchText) ~= nil or searchText == ""
        end
    end)
end)

-- RESPONSIVE DESIGN
workspace.CurrentCamera:GetPropertyChangedSignal("ViewportSize"):Connect(updateSize)

local lastOrientation = nil
local orientationCheckConnection
orientationCheckConnection = RunService.RenderStepped:Connect(function()
    local viewportSize = workspace.CurrentCamera.ViewportSize
    local currentOrientation = viewportSize.X > viewportSize.Y and "Landscape" or "Portrait"
    
    if currentOrientation ~= lastOrientation then
        lastOrientation = currentOrientation
        updateSize()
    end
end)

-- CLEANUP
local function cleanup()
    env.DrakthonHubLoaded = false
    
    if orientationCheckConnection then
        orientationCheckConnection:Disconnect()
    end
    
    if DrakthonHub and DrakthonHub.Parent then
        DrakthonHub:Destroy()
    end
    
    imageCache = {}
    allScripts = {}
    loadedPages = {}
    mapCards = {}
    
    env.DrakthonHubInstance = nil
end

env.DrakthonCleanup = cleanup

-- LAUNCH
MainFrame.Size = UDim2.new(0, 0, 0, 0)
MainFrame.Parent = DrakthonHub
DrakthonHub.Parent = PlayerGui

playSound(Sounds.Open)

TweenService:Create(MainFrame, 
    TweenInfo.new(Config.AnimationSpeed * 2, Enum.EasingStyle.Back, Enum.EasingDirection.Out), 
    {Size = getOptimalSize()}
):Play()

-- WELCOME
task.wait(1)
createNotification("Welcome", "Drakthon Hub v5.2 loaded", "success")

task.wait(2.5)
createNotification("Discord", "Join for updates & support", "info")

-- PROTECTION
if syn and syn.protect_gui then
    pcall(function()
        syn.protect_gui(DrakthonHub)
    end)
end

Players.PlayerRemoving:Connect(function(player)
    if player == Player then
        cleanup()
    end
end)

print("========================================")
print("Discord: https://discord.gg/W3VwkUj6kf")
print("========================================")